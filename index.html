```html
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test de la Amistad</title>
    <style>
        :root {
            --main-color: #6a0dad;
            --secondary-color: #9370db;
            --light-purple: #e6d5ff;
            --background: #f9f3ff;
            --text-dark: #4b0082;
            --text-light: #f8f2ff;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background-color: var(--background);
            color: var(--text-dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--main-color), var(--secondary-color));
            color: white;
            padding: 20px 0;
            text-align: center;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 4px 12px rgba(106, 13, 173, 0.2);
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        h2 {
            color: var(--main-color);
            margin: 25px 0 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--light-purple);
        }
        
        .card {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(147, 112, 219, 0.15);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(147, 112, 219, 0.25);
        }
        
        .btn {
            display: inline-block;
            background-color: var(--main-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1rem;
            text-decoration: none;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }
        
        .btn:hover {
            background-color: var(--secondary-color);
            transform: scale(1.05);
        }
        
        .btn-secondary {
            background-color: var(--light-purple);
            color: var(--text-dark);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        input[type="text"],
        input[type="password"],
        input[type="email"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--light-purple);
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        
        input[type="text"]:focus,
        input[type="password"]:focus,
        input[type="email"]:focus,
        select:focus,
        textarea:focus {
            border-color: var(--secondary-color);
            outline: none;
        }
        
        .hidden {
            display: none;
        }
        
        .question {
            margin-bottom: 25px;
            padding: 20px;
            background-color: var(--light-purple);
            border-radius: 10px;
            position: relative;
        }
        
        .question-number {
            position: absolute;
            top: -10px;
            left: -10px;
            background-color: var(--main-color);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .options {
            margin-top: 10px;
        }
        
        .option {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .option input[type="radio"],
        .option input[type="checkbox"] {
            margin-right: 10px;
        }
        
        .results-container {
            margin-top: 30px;
        }
        
        .participant-result {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(106, 13, 173, 0.1);
        }
        
        .participant-name {
            font-size: 1.3rem;
            color: var(--main-color);
            margin-bottom: 10px;
        }
        
        .participant-score {
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .answer-item {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }
        
        .answer-item::before {
            content: "•";
            position: absolute;
            left: 5px;
            color: var(--secondary-color);
        }
        
        .correct {
            color: #2e8b57;
            font-weight: bold;
        }
        
        .incorrect {
            color: #dc143c;
        }
        
        .open-answer {
            font-style: italic;
            color: #555;
        }
        
        .test-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .test-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(147, 112, 219, 0.1);
            transition: all 0.3s ease;
        }
        
        .test-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(147, 112, 219, 0.2);
        }
        
        .test-title {
            font-size: 1.2rem;
            color: var(--main-color);
            margin-bottom: 10px;
        }
        
        .test-author {
            color: #666;
            margin-bottom: 15px;
        }
        
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .user-info {
            display: flex;
            align-items: center;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            background-color: var(--secondary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
        }
        
        .tab-container {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--light-purple);
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            border-bottom: 3px solid var(--main-color);
            color: var(--main-color);
            font-weight: bold;
        }
        
        .tab:hover:not(.active) {
            border-bottom: 3px solid var(--secondary-color);
        }
        
        @media (max-width: 768px) {
            .test-list {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Test de la Amistad</h1>
            <p>¿Cuánto te conocen realmente tus amigos?</p>
        </div>
    </header>
    <div class="container">
        <!-- Pantalla de inicio de sesión/registro -->
        <div id="auth-screen" class="card">
            <div class="tab-container">
                <div class="tab active" id="login-tab">Iniciar sesión</div>
                <div class="tab" id="register-tab">Registrarse</div>
            </div>
            
            <div id="login-form">
                <h2>Inicia sesión</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label for="login-email">Correo electrónico</label>
                        <input type="email" id="login-email" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Contraseña</label>
                        <input type="password" id="login-password" required>
                    </div>
                    <button type="submit" class="btn">Iniciar sesión</button>
                </form>
            </div>
            
            <div id="register-form" class="hidden">
                <h2>Regístrate</h2>
                <form id="registerForm">
                    <div class="form-group">
                        <label for="register-name">Nombre</label>
                        <input type="text" id="register-name" required>
                    </div>
                    <div class="form-group">
                        <label for="register-email">Correo electrónico</label>
                        <input type="email" id="register-email" required>
                    </div>
                    <div class="form-group">
                        <label for="register-password">Contraseña</label>
                        <input type="password" id="register-password" required>
                    </div>
                    <button type="submit" class="btn">Registrarse</button>
                </form>
            </div>
        </div>
        
        <!-- Pantalla principal después del login -->
        <div id="main-screen" class="hidden">
            <div class="nav">
                <h2 id="welcome-message">Bienvenido, Usuario</h2>
                <div class="user-info">
                    <div class="user-avatar" id="user-avatar">U</div>
                    <button id="logout-btn" class="btn btn-secondary">Cerrar sesión</button>
                </div>
            </div>
            
            <div class="tab-container">
                <div class="tab active" id="my-tests-tab">Mis Tests</div>
                <div class="tab" id="take-test-tab">Responder Test</div>
                <div class="tab" id="create-test-tab">Crear Test</div>
            </div>
            
            <!-- Mis Tests -->
            <div id="my-tests-content">
                <h2>Mis Tests de Amistad</h2>
                <button id="create-new-test-btn" class="btn">Crear nuevo test</button>
                
                <div class="test-list" id="test-list">
                    <!-- Los tests se cargarán aquí dinámicamente -->
                </div>
            </div>
            
            <!-- Responder Test -->
            <div id="take-test-content" class="hidden">
                <h2>Responder Test de Amistad</h2>
                <div class="form-group">
                    <label for="test-code">Código del Test</label>
                    <input type="text" id="test-code" placeholder="Ingresa el código del test que quieres responder">
                    <button id="load-test-btn" class="btn">Cargar Test</button>
                </div>
                
                <div id="test-to-take" class="hidden">
                    <h3 id="test-author">Test creado por: <span id="author-name"></span></h3>
                    
                    <div class="form-group">
                        <label for="participant-name">Tu nombre</label>
                        <input type="text" id="participant-name" placeholder="Cómo quieres que te llamemos">
                    </div>
                    
                    <form id="friendship-test-form">
                        <!-- Las preguntas del test se cargarán aquí dinámicamente -->
                    </form>
                    
                    <button id="submit-test-btn" class="btn">Enviar respuestas</button>
                </div>
            </div>
            
             <!-- Crear Test -->
            <div id="create-test-content" class="hidden">
                <h2>Crear tu Test de Amistad</h2>
                
                <div class="form-group">
                    <label for="test-title">Título del Test</label>
                    <input type="text" id="test-title" placeholder="Ej: ¿Cuánto me conoces?">
                </div>
                
                <h3>Preguntas del Test</h3>
                
                <div id="test-questions">
                    <!-- Las preguntas se agregarán aquí dinámicamente -->
                </div>
                
                <button id="add-question-btn" class="btn btn-secondary">Agregar pregunta</button>
                <button id="save-test-btn" class="btn">Guardar Test</button>
            </div>
            
            <!-- Resultados del Test -->
            <div id="test-results-content" class="hidden">
                <h2>Resultados del Test: <span id="results-test-title"></span></h2>
                <p>Código del test: <strong id="results-test-code"></strong></p>
                
                <div id="test-results-stats" class="card">
                    <h3>Estadísticas</h3>
                    <p>Total de participantes: <span id="total-participants">0</span></p>
                    <p>Puntuación promedio: <span id="average-score">0</span>/<span id="total-questions">0</span></p>
                </div>
                
                <div id="participants-results">
                    <h3>Respuestas de tus amigos</h3>
                    <!-- Los resultados se cargarán aquí dinámicamente -->
                </div>
                
                <button id="back-to-tests-btn" class="btn">Volver a mis tests</button>
            </div>
        </div>
    </div>

    <script>
        // Datos de la aplicación
        let currentUser = null;
        let users = JSON.parse(localStorage.getItem('friendshipTestUsers')) || [];
        let tests = JSON.parse(localStorage.getItem('friendshipTests')) || [];
        let currentTest = null;
        let currentTestResponses = [];
        
        // Elementos del DOM
        const authScreen = document.getElementById('auth-screen');
        const mainScreen = document.getElementById('main-screen');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const loginTab = document.getElementById('login-tab');
        const registerTab = document.getElementById('register-tab');
        const loginFormDiv = document.getElementById('login-form');
        const registerFormDiv = document.getElementById('register-form');
        const welcomeMessage = document.getElementById('welcome-message');
        const userAvatar = document.getElementById('user-avatar');
        const logoutBtn = document.getElementById('logout-btn');
        
        // Tabs
        const myTestsTab = document.getElementById('my-tests-tab');
        const takeTestTab = document.getElementById('take-test-tab');
        const createTestTab = document.getElementById('create-test-tab');
        const myTestsContent = document.getElementById('my-tests-content');
        const takeTestContent = document.getElementById('take-test-content');
        const createTestContent = document.getElementById('create-test-content');
        const testResultsContent = document.getElementById('test-results-content');
        
        // Funciones de autenticación
        function login(email, password) {
            const user = users.find(u => u.email === email && u.password === password);
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                authScreen.classList.add('hidden');
                mainScreen.classList.remove('hidden');
                updateUI();
                loadUserTests();
                return true;
            }
            return false;
        }
        
        function register(name, email, password) {
            if (users.some(u => u.email === email)) {
                return false;
            }
            
            const newUser = {
                id: Date.now().toString(),
                name,
                email,
                password,
                avatarColor: getRandomColor()
            };
            
            users.push(newUser);
            localStorage.setItem('friendshipTestUsers', JSON.stringify(users));
            
            // Iniciar sesión automáticamente después del registro
            login(email, password);
            return true;
        }
        
        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            mainScreen.classList.add('hidden');
            authScreen.classList.remove('hidden');
        }
        
        function getRandomColor() {
            const colors = ['#6a0dad', '#9370db', '#8a2be2', '#9932cc', '#ba55d3'];
            return colors[Math.floor(Math.random() * colors.length)];
        }
        
        // Funciones de UI
        function updateUI() {
            if (currentUser) {
                welcomeMessage.textContent = `Bienvenido, ${currentUser.name}`;
                userAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
                userAvatar.style.backgroundColor = currentUser.avatarColor;
            }
        }
        
        function showTab(tabName) {
            // Ocultar todos los contenidos
            myTestsContent.classList.add('hidden');
            takeTestContent.classList.add('hidden');
            createTestContent.classList.add('hidden');
            testResultsContent.classList.add('hidden');
            
            // Desactivar todas las pestañas
            myTestsTab.classList.remove('active');
            takeTestTab.classList.remove('active');
            createTestTab.classList.remove('active');
            
            // Mostrar el contenido seleccionado
            if (tabName === 'my-tests') {
                myTestsContent.classList.remove('hidden');
                myTestsTab.classList.add('active');
                loadUserTests();
            } else if (tabName === 'take-test') {
                takeTestContent.classList.remove('hidden');
                takeTestTab.classList.add('active');
            } else if (tabName === 'create-test') {
                createTestContent.classList.remove('hidden');
                createTestTab.classList.add('active');
                resetTestCreation();
            }
        }
        
        function showTestResults(testId) {
            myTestsContent.classList.add('hidden');
            takeTestContent.classList.add('hidden');
            createTestContent.classList.add('hidden');
            testResultsContent.classList.remove('hidden');
            
            loadTestResults(testId);
        }
        
        // Funciones de tests
        function createTest(title, questions) {
            const testCode = generateTestCode();
            
            const newTest = {
                id: Date.now().toString(),
                title,
                code: testCode,
                authorId: currentUser.id,
                authorName: currentUser.name,
                questions,
                responses: [],
                createdAt: new Date().toISOString()
            };
            
            tests.push(newTest);
            localStorage.setItem('friendshipTests', JSON.stringify(tests));
            
            return newTest;
        }
        
        function generateTestCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = '';
            for (let i = 0; i < 6; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }
        
        function loadUserTests() {
            const testList = document.getElementById('test-list');
            testList.innerHTML = '';
            
            const userTests = tests.filter(test => test.authorId === currentUser.id);
            
            if (userTests.length === 0) {
                testList.innerHTML = '<p>No has creado ningún test aún. ¡Crea uno para empezar!</p>';
                return;
            }
            
            userTests.forEach(test => {
                const testCard = document.createElement('div');
                testCard.className = 'test-card';
                testCard.innerHTML = `
                    <h3 class="test-title">${test.title}</h3>
                    <p class="test-author">Código: ${test.code}</p>
                    <p>${test.questions.length} preguntas</p>
                    <p>${test.responses.length} respuestas</p>
                    <button class="btn view-results-btn" data-testid="${test.id}">Ver resultados</button>
                `;
                testList.appendChild(testCard);
            });
            
            // Agregar event listeners a los botones
            document.querySelectorAll('.view-results-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    showTestResults(this.getAttribute('data-testid'));
                });
            });
        }
        
        function loadTestToTake(testCode) {
            const test = tests.find(t => t.code === testCode);
            if (!test) {
                alert('No se encontró un test con ese código');
                return;
            }
            
            currentTest = test;
            
            const testForm = document.getElementById('friendship-test-form');
            testForm.innerHTML = '';
            
            document.getElementById('author-name').textContent = test.authorName;
            
            test.questions.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                
                const questionNumber = document.createElement('div');
                questionNumber.className = 'question-number';
                questionNumber.textContent = index + 1;
                
                const questionLabel = document.createElement('label');
                questionLabel.textContent = question.question;
                
                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'options';
                
                if (question.type === 'multiple-choice') {
                    question.options.forEach((option, i) => {
                        const optionDiv = document.createElement('div');
                        optionDiv.className = 'option';
                        
                        const input = document.createElement('input');
                        input.type = 'radio';
                        input.name = `q${index}`;
                        input.id = `q${index}-o${i}`;
                        input.value = option;
                        
                        const label = document.createElement('label');
                        label.htmlFor = `q${index}-o${i}`;
                        label.textContent = option;
                        
                        optionDiv.appendChild(input);
                        optionDiv.appendChild(label);
                        optionsDiv.appendChild(optionDiv);
                    });
                } else if (question.type === 'open-ended') {
                    const textarea = document.createElement('textarea');
                    textarea.name = `q${index}`;
                    textarea.rows = 3;
                    textarea.placeholder = 'Escribe tu respuesta aquí';
                    optionsDiv.appendChild(textarea);
                }
                
                questionDiv.appendChild(questionNumber);
                questionDiv.appendChild(questionLabel);
                questionDiv.appendChild(optionsDiv);
                testForm.appendChild(questionDiv);
            });
            
            document.getElementById('test-to-take').classList.remove('hidden');
        }
        
        function submitTestResponse(testId, participantName, answers) {
            const test = tests.find(t => t.id === testId);
            if (!test) return;
            
            // Calcular puntuación
            let score = 0;
            const detailedAnswers = [];
            
            test.questions.forEach((question, index) => {
                const answer = answers[index];
                let isCorrect = false;
                
                if (question.type === 'multiple-choice') {
                    isCorrect = answer === question.correctAnswer;
                    if (isCorrect) score++;
                }
                
                detailedAnswers.push({
                    question: question.question,
                    answer: answer,
                    correctAnswer: question.correctAnswer,
                    isCorrect: isCorrect
                });
            });
            
            const response = {
                participantName,
                score,
                totalQuestions: test.questions.length,
                answers: detailedAnswers,
                date: new Date().toISOString()
            };
            
            test.responses.push(response);
            localStorage.setItem('friendshipTests', JSON.stringify(tests));
            
            // Mostrar resultados al participante
            showTestResultsForParticipant(test, response);
        }
        
        function showTestResultsForParticipant(test, response) {
            takeTestContent.classList.add('hidden');
            testResultsContent.classList.remove('hidden');
            
            document.getElementById('results-test-title').textContent = test.title;
            document.getElementById('results-test-code').textContent = test.code;
            
            const resultsDiv = document.createElement('div');
            resultsDiv.className = 'participant-result';
            
            resultsDiv.innerHTML = `
                <h3 class="participant-name">Resultados para: ${response.participantName}</h3>
                <p class="participant-score">Puntuación: ${response.score}/${response.totalQuestions}</p>
                <div id="participant-answers"></div>
            `;
            
            document.getElementById('participants-results').innerHTML = '';
            document.getElementById('participants-results').appendChild(resultsDiv);
            
            const answersDiv = document.getElementById('participant-answers');
            
            response.answers.forEach((answer, index) => {
                const answerDiv = document.createElement('div');
                answerDiv.className = 'answer-item';
                
                let answerContent = '';
                if (answer.correctAnswer) {
                    // Pregunta con respuesta correcta definida
                    answerContent = `
                        <strong>Pregunta ${index + 1}:</strong> ${answer.question}<br>
                        <span class="${answer.isCorrect ? 'correct' : 'incorrect'}">
                            Tu respuesta: ${answer.answer} 
                            ${answer.isCorrect ? '✓ Correcto' : `✗ Incorrecto (Correcto: ${answer.correctAnswer})`}
                        </span>
                    `;
                } else {
                    // Pregunta abierta
                    answerContent = `
                        <strong>Pregunta ${index + 1}:</strong> ${answer.question}<br>
                        <span class="open-answer">Tu respuesta: ${answer.answer}</span>
                    `;
                }
                
                answerDiv.innerHTML = answerContent;
                answersDiv.appendChild(answerDiv);
            });
        }
        
        function loadTestResults(testId) {
            const test = tests.find(t => t.id === testId);
            if (!test) return;
            
            document.getElementById('results-test-title').textContent = test.title;
            document.getElementById('results-test-code').textContent = test.code;
            document.getElementById('total-participants').textContent = test.responses.length;
            document.getElementById('total-questions').textContent = test.questions.length;
            
            // Calcular puntuación promedio
            const avgScore = test.responses.length > 0 
                ? (test.responses.reduce((sum, res) => sum + res.score, 0) / test.responses.length).toFixed(1)
                : 0;
            document.getElementById('average-score').textContent = avgScore;
            
            const participantsResults = document.getElementById('participants-results');
            participantsResults.innerHTML = '';
            
            if (test.responses.length === 0) {
                participantsResults.innerHTML = '<p>No hay respuestas aún para este test.</p>';
                return;
            }
            
            test.responses.forEach(response => {
                const resultDiv = document.createElement('div');
                resultDiv.className = 'participant-result';
                
                resultDiv.innerHTML = `
                    <h3 class="participant-name">${response.participantName}</h3>
                    <p class="participant-score">Puntuación: ${response.score}/${response.totalQuestions}</p>
                    <button class="btn btn-secondary view-details-btn">Ver detalles</button>
                    <div class="answer-details hidden"></div>
                `;
                
                const detailsDiv = resultDiv.querySelector('.answer-details');
                
                response.answers.forEach((answer, index) => {
                    const answerItem = document.createElement('div');
                    answerItem.className = 'answer-item';
                    
                    let answerContent = '';
                    if (answer.correctAnswer) {
                        // Pregunta con respuesta correcta definida
                        answerContent = `
                            <strong>Pregunta ${index + 1}:</strong> ${answer.question}<br>
                            <span class="${answer.isCorrect ? 'correct' : 'incorrect'}">
                                Respuesta: ${answer.answer} 
                                ${answer.isCorrect ? '✓ Correcto' : `✗ Incorrecto (Correcto: ${answer.correctAnswer})`}
                            </span>
                        `;
                    } else {
                        // Pregunta abierta
                        answerContent = `
                            <strong>Pregunta ${index + 1}:</strong> ${answer.question}<br>
                            <span class="open-answer">Respuesta: ${answer.answer}</span>
                        `;
                    }
                    
                    answerItem.innerHTML = answerContent;
                    detailsDiv.appendChild(answerItem);
                });
                
                participantsResults.appendChild(resultDiv);
                
                // Agregar evento para mostrar/ocultar detalles
                resultDiv.querySelector('.view-details-btn').addEventListener('click', function() {
                    detailsDiv.classList.toggle('hidden');
                    this.textContent = detailsDiv.classList.contains('hidden') ? 'Ver detalles' : 'Ocultar detalles';
                });
            });
        }
        
        function resetTestCreation() {
            document.getElementById('test-title').value = '';
            document.getElementById('test-questions').innerHTML = '';
        }
        
        function addQuestionToTest() {
            const questionsDiv = document.getElementById('test-questions');
            const questionCount = questionsDiv.children.length;
            
            const questionDiv = document.createElement('div');
            questionDiv.className = 'question';
            questionDiv.innerHTML = `
                <div class="question-number">${questionCount + 1}</div>
                <div class="form-group">
                    <label>Texto de la pregunta</label>
                    <input type="text" class="question-text" placeholder="Escribe la pregunta">
                </div>
                <div class="form-group">
                    <label>Tipo de pregunta</label>
                    <select class="question-type">
                        <option value="multiple-choice">Selección múltiple</option>
                        <option value="open-ended">Respuesta abierta</option>
                    </select>
                </div>
                <div class="multiple-choice-options ${questionCount > 0 ? 'hidden' : ''}">
                    <div class="form-group">
                        <label>Opciones (marca la correcta)</label>
                        <div class="options-container">
                            <div class="option-input">
                                <input type="radio" name="correct-answer-${questionCount}" value="0" checked>
                                <input type="text" class="option-text" placeholder="Opción 1">
                            </div>
                            <div class="option-input">
                                <input type="radio" name="correct-answer-${questionCount}" value="1">
                                <input type="text" class="option-text" placeholder="Opción 2">
                            </div>
                        </div>
                        <button type="button" class="btn btn-secondary add-option-btn">Agregar opción</button>
                    </div>
                </div>
                <button type="button" class="btn btn-secondary remove-question-btn">Eliminar pregunta</button>
            `;
     
     questionsDiv.appendChild(questionDiv);
            
            // Event listener para cambiar tipo de pregunta
            questionDiv.querySelector('.question-type').addEventListener('change', function() {
                const optionsDiv = questionDiv.querySelector('.multiple-choice-options');
                if (this.value === 'multiple-choice') {
                    optionsDiv.classList.remove('hidden');
                } else {
                    optionsDiv.classList.add('hidden');
                }
            });
            
            // Event listener para agregar opción
            questionDiv.querySelector('.add-option-btn').addEventListener('click', function() {
                const optionsContainer = questionDiv.querySelector('.options-container');
                const optionCount = optionsContainer.children.length;
                
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option-input';
                optionDiv.innerHTML = `
                    <input type="radio" name="correct-answer-${questionCount}" value="${optionCount}">
                    <input type="text" class="option-text" placeholder="Opción ${optionCount + 1}">
                    <button type="button" class="btn btn-secondary remove-option-btn">X</button>
                `;
                
                optionsContainer.appendChild(optionDiv);
                
                // Event listener para eliminar opción
                optionDiv.querySelector('.remove-option-btn').addEventListener('click', function() {
                    optionsContainer.removeChild(optionDiv);
                    
                    // Reindexar las opciones restantes
                    const remainingOptions = optionsContainer.querySelectorAll('.option-input');
                    remainingOptions.forEach((opt, idx) => {
                        opt.querySelector('input[type="radio"]').value = idx;
                        opt.querySelector('.option-text').placeholder = `Opción ${idx + 1}`;
                    });
                });
            });
            
            // Event listener para eliminar pregunta
            questionDiv.querySelector('.remove-question-btn').addEventListener('click', function() {
                questionsDiv.removeChild(questionDiv);
                
                // Renumerar las preguntas restantes
                const remainingQuestions = questionsDiv.querySelectorAll('.question');
                remainingQuestions.forEach((q, idx) => {
                    q.querySelector('.question-number').textContent = idx + 1;
                });
            });
        }
        
        function saveTest() {
            const title = document.getElementById('test-title').value.trim();
            if (!title) {
                alert('Por favor ingresa un título para el test');
                return;
            }
            
            const questionDivs = document.getElementById('test-questions').children;
            if (questionDivs.length === 0) {
                alert('Debes agregar al menos una pregunta');
                return;
            }
            
            const questions = [];
            
            for (let i = 0; i < questionDivs.length; i++) {
                const questionDiv = questionDivs[i];
                const questionText = questionDiv.querySelector('.question-text').value.trim();
                const questionType = questionDiv.querySelector('.question-type').value;
                
                if (!questionText) {
                    alert(`Por favor ingresa el texto para la pregunta ${i + 1}`);
                    return;
                }
                
                if (questionType === 'multiple-choice') {
                    const optionInputs = questionDiv.querySelectorAll('.option-text');
                    const options = [];
                    let correctAnswer = '';
                    
                    for (let j = 0; j < optionInputs.length; j++) {
                        const optionText = optionInputs[j].value.trim();
                        if (!optionText) {
                            alert(`Por favor ingresa el texto para la opción ${j + 1} de la pregunta ${i + 1}`);
                            return;
                        }
                        
                        options.push(optionText);
                        
                        // Verificar si esta opción es la correcta
                        const radioBtn = optionInputs[j].previousElementSibling;
                        if (radioBtn.checked) {
                            correctAnswer = optionText;
                        }
                    }
                    
                    if (options.length < 2) {
                        alert(`Debes agregar al menos 2 opciones para la pregunta ${i + 1}`);
                        return;
                    }
                    
                    if (!correctAnswer) {
                        alert(`Debes seleccionar una opción correcta para la pregunta ${i + 1}`);
                        return;
                    }
                    
                    questions.push({
                        question: questionText,
                        type: 'multiple-choice',
                        options: options,
                        correctAnswer: correctAnswer
                    });
                } else {
                    questions.push({
                        question: questionText,
                        type: 'open-ended'
                    });
                }
            }
            
            const test = createTest(title, questions);
            alert(`Test creado exitosamente! Código para compartir: ${test.code}`);
            showTab('my-tests');
        }
        
        // Event Listeners
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            if (login(email, password)) {
                alert('Inicio de sesión exitoso');
            } else {
                alert('Correo electrónico o contraseña incorrectos');
            }
        });
        
        registerForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('register-name').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            
            if (register(name, email, password)) {
                alert('Registro exitoso. ¡Bienvenido!');
            } else {
                alert('Ya existe un usuario con ese correo electrónico');
            }
        });
        
        loginTab.addEventListener('click', function() {
            loginTab.classList.add('active');
            registerTab.classList.remove('active');
            loginFormDiv.classList.remove('hidden');
            registerFormDiv.classList.add('hidden');
        });       
         registerTab.addEventListener('click', function() {
            registerTab.classList.add('active');
            loginTab.classList.remove('active');
            registerFormDiv.classList.remove('hidden');
            loginFormDiv.classList.add('hidden');
        });
        
        logoutBtn.addEventListener('click', logout);
        
        myTestsTab.addEventListener('click', () => showTab('my-tests'));
        takeTestTab.addEventListener('click', () => showTab('take-test'));
        createTestTab.addEventListener('click', () => showTab('create-test'));
        
        document.getElementById('create-new-test-btn').addEventListener('click', () => showTab('create-test'));
        document.getElementById('back-to-tests-btn').addEventListener('click', () => showTab('my-tests'));
        
        document.getElementById('load-test-btn').addEventListener('click', function() {
            const testCode = document.getElementById('test-code').value.trim();
            if (testCode) {
                loadTestToTake(testCode);
            } else {
                alert('Por favor ingresa un código de test');
            }
        });
        
        document.getElementById('submit-test-btn').addEventListener('click', function() {
            const participantName = document.getElementById('participant-name').value.trim();
            if (!participantName) {
                alert('Por favor ingresa tu nombre');
                return;
            }
            
            const answers = [];
            const form = document.getElementById('friendship-test-form');
            const questionDivs = form.querySelectorAll('.question');
            
            questionDivs.forEach((questionDiv, index) => {
                if (currentTest.questions[index].type === 'multiple-choice') {
                    const selectedOption = questionDiv.querySelector('input[type="radio"]:checked');
                    answers.push(selectedOption ? selectedOption.nextElementSibling.textContent : '');
                } else {
                    const textarea = questionDiv.querySelector('textarea');
                    answers.push(textarea ? textarea.value : '');
                }
            });
            
            submitTestResponse(currentTest.id, participantName, answers);
        });
        
        document.getElementById('add-question-btn').addEventListener('click', addQuestionToTest);
        document.getElementById('save-test-btn').addEventListener('click', saveTest);
        
        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar si hay un usuario logueado
            const storedUser = localStorage.getItem('currentUser');
            if (storedUser) {
                currentUser = JSON.parse(storedUser);
                authScreen.classList.add('hidden');
                mainScreen.classList.remove('hidden');
                updateUI();
                loadUserTests();
            }
            
            // Agregar primera pregunta al crear test
            document.getElementById('create-test-tab').addEventListener('click', addQuestionToTest);
        });
    </script>
</body>
</html>
```